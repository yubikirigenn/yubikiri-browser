<div id="viewer"></div>

<script>
async function openSite(url) {
  const r = await fetch('/proxy/can-iframe?url=' + encodeURIComponent(url));
  const j = await r.json();
  const viewer = document.getElementById('viewer');
  viewer.innerHTML = ''; // クリア

  const iframe = document.createElement('iframe');
  iframe.style.width = '100%';
  iframe.style.height = '100vh';
  iframe.frameBorder = '0';

  if (j.allowIframe) {
    // iframe 埋め込み可能
    iframe.src = url;
  } else {
    // 埋め込み不可 → プロキシ経由
    iframe.src = '/proxy?url=' + encodeURIComponent(url);
  }

  viewer.appendChild(iframe);
}
</script>
